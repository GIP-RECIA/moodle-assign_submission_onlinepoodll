{"version":3,"sources":["../src/submissionhelper.js"],"names":["define","$","log","str","debug","uploadstate","togglestate","strings","init","opts","component","filecontrolid","togglingthing","register_controls","register_events","toggle_currentsubmission","that","controls","deletebutton","updatecontrol","currentcontainer","reccontainer","togglecontainer","togglebutton","toggletext","get_string","done","s","click","confirm","M","util","val","html","toggle_recorder","do_toggle","removeClass","addClass","text","toggle","duration","complete"],"mappings":"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","sourcesContent":["define(['jquery','core/log','core/str'], function($,log,str) {\n    \"use strict\"; // jshint ;_;\n\n    log.debug('submission helper: initialising');\n\n    return {\n\n        uploadstate: false,\n        togglestate: 0,\n        strings: {},\n\n\n        init:  function(opts) {\n\n            this.component = opts['component'];\n            this.filecontrolid = opts['filecontrolid'];\n            this.togglingthing = opts['togglingthing'];\n            this.register_controls();\n            this.register_events();\n\n\n            //we might want to expand current submission by default.\n            if(this.togglingthing=='currentsubmission') {\n                if (opts['expandcurrentsubmission']) {\n                    this.toggle_currentsubmission(this);\n                }\n            }\n        },\n\n        register_controls: function(){\n          var that=this;\n          this.controls={};\n          this.controls.deletebutton = $('.' + this.component + '_deletesubmissionbutton');\n          this.controls.updatecontrol =  $('#' + this.filecontrolid);\n          this.controls.currentcontainer =  $('.' + this.component + '_currentsubmission');\n          this.controls.reccontainer =  $('.' + this.component + '_recorder');\n          this.controls.togglecontainer =  $('.' + this.component + '_togglecontainer');\n          this.controls.togglebutton =  $('.' + this.component + '_togglecontainer .togglebutton');\n          this.controls.toggletext =  $('.' + this.component + '_togglecontainer .toggletext');\n\n\n            str.get_string('clicktohide',that.component).done(function(s) {\n                that.strings['clicktohide']=s;\n            });\n            str.get_string('clicktoshow',that.component).done(function(s) {\n                that.strings['clicktoshow']=s;\n            });\n        },\n\n        register_events: function(){\n            var that =this;\n            this.controls.deletebutton.click(function(){\n                if(that.controls.updatecontrol){\n                    if(confirm(M.util.get_string('reallydeletesubmission',that.component))){\n                        that.controls.updatecontrol.val(-1);\n                        that.controls.currentcontainer.html('');\n                    }\n                }\n            });\n\n            //we only toggle(hide/show) currentsubmission OR recorder, not both\n            if(this.togglingthing==='currentsubmission') {\n                this.controls.togglebutton.click(function () {\n                    that.toggle_currentsubmission(that);\n                });\n                this.controls.toggletext.click(function () {\n                    that.toggle_currentsubmission(that);\n                });\n            }else if(this.togglingthing==='recorder') {\n                this.controls.togglebutton.click(function () {\n                    that.toggle_recorder(that);\n                });\n                this.controls.toggletext.click(function () {\n                    that.toggle_recorder(that);\n                });\n            }\n        },\n\n        do_toggle: function(that){\n            if(that.togglestate===0){\n                that.controls.togglebutton.removeClass('fa-toggle-off');\n                that.controls.togglebutton.addClass('fa-toggle-on');\n                that.controls.toggletext.text(that.strings['clicktohide']);\n                that.togglestate=1;\n            }else{\n                that.controls.togglebutton.removeClass('fa-toggle-on');\n                that.controls.togglebutton.addClass('fa-toggle-off');\n                that.controls.toggletext.text(that.strings['clicktoshow']);\n                that.togglestate=0;\n            }\n        },\n\n        toggle_currentsubmission: function(that){\n            that.controls.currentcontainer.toggle(\n                {duration: 300, complete: function(){that.do_toggle(that);}}\n            );\n            return false;\n        },\n\n        toggle_recorder: function(that){\n            that.controls.reccontainer.toggle(\n                {duration: 300, complete: function(){that.do_toggle(that);}}\n            );\n            return false;\n        }\n    };//end of return object\n});"],"file":"submissionhelper.min.js"}